<!DOCTYPE html>
<html xmlns:th="http://www.springframework.org/schema/data/jaxb"
      th:replace="~{masterLayout :: layout(~{::title}, ~{::content}, ~{::headContent})}">
<head>
    <headContent>
        <title>Modal</title>
        <link rel="stylesheet" type="text/css" th:href="@{/css/modal.css}">
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    </headContent>
</head>
<body>
<content>
    <!--for ajax request    -->
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

    <button class="btn" id="categoryBtn">Category</button>
    <button class="btn" id="itemBtn">Item</button>
    <div id="categoryModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <span class="close">&times;</span>
          <h2>New Category</h2>
        </div>
        <div class="modal-body">
            <form>
                <div class="form-group">
                    <label class="form-label">Category Name</label><br>
                    <input id="ctg-new-name" class="form-input" type="" name="">
                </div>
                <div class="form-group">
                    <label class="form-label">Category Parent</label><br>
                    <select id="select-parent-ctg" class="form-input" style="width: 100%;">
                    <th:block th:each="category : ${categories}">
                        <option th:value="${category.id}" th:text="${category.name}">Option i</option>
                    </th:block>
                    </select>
                </div>
                <div class="form-action">
                    <div id="submit-new-ctg" class="submit">Add Category</div>
                </div>
            </form>
        </div>
      </div>
    </div>
    <div id="itemModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <span class="close">&times;</span>
          <h2>New Item</h2>
        </div>
        <div class="modal-body">
            <div>
                <div class="form-group">
                    <label class="form-label">Item Name</label><br>
                    <input class="form-input" type="" name="">
                </div>
                <div class="form-group">
                    <label class="form-label">Item Quantity</label><br>
                    <input class="form-input" type="" name="">
                </div>
                <div class="form-group">
                    <label class="form-label">Item Price</label><br>
                    <input class="form-input" type="" name="">
                </div>
                <div class="form-group">
                    <label class="form-label">Item Category</label><br>
                    <select class="form-input" style="width: 100%;">
                        <option>Option 1</option>
                        <option>Option 1</option>
                        <option>Option 1</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label><br>
                    <input class="form-input" type="" name="">
                </div>
                <div class="form-action">
                    <button class="submit">Add Item</button>
                </div>
            </div>
        </div>
      </div>
    </div>
    <script>

        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="_csrf"]').attr('content')
            }
        });

        $('#submit-new-ctg').click(function () {
            $.ajax({
                url: "[[@{/items/category/create}]]",
                type: 'POST',
                contentType : "application/json; charset=utf-8",
                data : JSON.stringify({
                    "name": $('#ctg-new-name').val(),
                    "parent_id": $('#select-parent-ctg').val()
                }),
                success: function (response) {
                    console.log(response);
                }
            }).fail(function (xhr, error, thrownError) {
                alert('something wrong :(');
            });

        });



        var modal = document.getElementById('categoryModal');
        var modal2 = document.getElementById('itemModal');
        var btn = document.getElementById("categoryBtn");
        var btn2 = document.getElementById("itemBtn");
        var span = document.getElementsByClassName("close")[0];
        var span2 = document.getElementsByClassName("close")[1];
        btn.onclick = function() {
            modal.style.display = "block";
        }
        span.onclick = function() {
            modal.style.display = "none";
        }
        btn2.onclick = function() {
            modal2.style.display = "block";
        }
        span2.onclick = function() {
            modal2.style.display = "none";
        }
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
            if (event.target == modal2) {
                modal2.style.display = "none";
            }
        }
    </script>
</content>
</body>
</html>
