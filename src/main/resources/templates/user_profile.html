<!DOCTYPE html>
<html xmlns:th="http://www.springframework.org/schema/data/jaxb">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<link rel="stylesheet" type="text/css" th:href="@{css/user_profile.css}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<title>User Profile</title>
</head>
<body>
	<div id="sidebar">
		<div id="top">
			<div id="invenger-text">INVENGER</div><i onclick="myFunction()" id="bars" class="fa fa-bars"></i>
		</div>
		<div id="element">MENUS</div>
		<a class="icon" href="">
			<i class="fa fa-cloud"></i><div class="text">Options</div>
		</a>
		<a class="icon" id="selected" href="">
			<i class="fa fa-cloud"></i><div class="text">Options</div>
		</a>
		<a class="icon" href="">
			<i class="fa fa-cloud"></i><div class="text">Options</div>
		</a>
		<a class="icon" href="">
			<i class="fa fa-cloud"></i><div class="text">Options</div>
		</a>
		<a class="icon" href="">
			<i class="fa fa-cloud"></i><div class="text">Options</div>
		</a>
	</div>
	<div id="content">
		<div class="navbar"></div>
		<div class="user-text">User Profile</div>
		<div class="profile">
			<div class="pic">
				<div class="image"></div>
				<div class="change">
					<div class="ava">Avatar</div>
					<button class="btn">Change</button>
				</div>
			</div>
			<div class="field">
				<form id="user-form" th:object="${user}" th:action="@{/profile}" method="post">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
					<div class="form-group">
						<label class="form-label">Name</label><br>
						<input disabled class="form-input" type="text" th:field="*{username}">
					</div>
                    <div class="form-group">
                        <label class="form-label">Position</label>
                        <input disabled class="form-input" type="text" th:field="*{position.name}">
                    </div>
					<div class="form-group">
						<label class="form-label">Email</label>
						<input disabled class="form-input" type="text" th:field="*{email}">
					</div>
					<div class="form-group">
						<label class="form-label">Telp</label>
						<input class="form-input" type="text" th:field="*{telp}">
                        <input type="hidden" name="new-telp">
					</div>
                    <div class="form-group">
                        <a id="change-pwd">Change password?</a>
                    </div>
                    <div id="pwd-field" class="row" style="display:none">
                        <div class="col-md-4">
                            <input name="old-pwd" type="password" class="form-control" placeholder="Old password"> </div>
                        <div class="col-md-4">
                            <input name="new-pwd1" type="password" class="form-control" placeholder="New password"> </div>
                        <div class="col-md-4">
                            <input name="new-pwd2" type="password" class="form-control" placeholder="Confirm password"> </div>
                        <input type="hidden" name="new-pwd2">
                    </div>
					<div class="form-action">
						<button id="bt-submit" class="submit">Update Profile</button>
					</div>
				</form>
			</div>
		</div>
	</div> 
	<script>
        console.log($('#pwd-field').css('display'));

        $('#change-pwd').click(function(){
            if($('#pwd-field').css('display') === 'none'){
                $('#pwd-field').slideDown();
            }
            else{
                $('#pwd-field').slideUp();
                $('#old-pwd').val("");
                $('#new-pwd1').val("");
                $('#new-pwd2').val("");
            }
        });

        var old_telp = "[[${user.telp}]]";

        $('#bt-submit').click(function () {

            if( old_telp != $('input[name="telp"]').val() ){
                $('input[name="new-telp"]').val($('input[name="telp"]').val());
            }
            $('#user-form').submit();
        });

        function myFunction(){
			var z = document.getElementsByClassName("text");
			var a = document.getElementsByClassName("icon");
			var y = document.getElementById("top");
		    var x = document.getElementById("invenger-text");
		    if (x.style.display === "none"){
		    	document.getElementById("sidebar").style.width = "250px";
		    	document.getElementById("content").style.marginLeft = "250px";
		        x.style.display = "flex";
		        y.style.padding = "18px 32px";
		        document.getElementById("element").style.textAlign = "left";
		        document.getElementById("element").style.margin = "12px 32px";
		        for (var i = z.length - 1; i >= 0; i--) {
		        	z[i].style.display = "flex";
		        }
		        for (var i = a.length - 1; i >= 0; i--) {
		        	a[i].style.padding = "12px 32px";
		        }
		    }
		    else{
		    	document.getElementById("sidebar").style.width = "auto";
		    	document.getElementById("content").style.marginLeft = "57.15px";
		        x.style.display = "none";
		        y.style.padding = "20px 20px";
		        document.getElementById("element").style.textAlign = "center";
		        document.getElementById("element").style.margin = "12px 0px";
		        for (var i = z.length - 1; i >= 0; i--) {
		        	z[i].style.display = "none";
		        }
		        for (var i = a.length - 1; i >= 0; i--) {
		        	a[i].style.padding = "12px 20px 15px 20px";
		        }
		    }
		}
	</script>
</body>
</html> 
